<!DOCTYPE html>
<html>
<head>
    <title>Test Frontend-Backend Connection</title>
</head>
<body style="font-family: Arial, sans-serif; padding: 20px;">
    <h1>🔗 Frontend-Backend Connection Test</h1>
    
    <div style="margin: 20px 0;">
        <button onclick="testConnection()" style="padding: 10px 20px; font-size: 16px; background: #0176D3; color: white; border: none; border-radius: 5px; cursor: pointer;">
            🧪 Test SSL Inspection
        </button>
    </div>
    
    <div id="output" style="background: #f5f5f5; padding: 15px; border-radius: 5px; white-space: pre-wrap; font-family: monospace;"></div>

    <script>
        async function testConnection() {
            const output = document.getElementById('output');
            output.textContent = '🔍 Testing SSL inspection...\n';
            
            try {
                const response = await fetch('http://localhost:3001/api/ssl-inspect', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        urls: [
                            { id: 1, url: "www.google.com", enabled: true }
                        ]
                    })
                });
                
                output.textContent += `📡 Response status: ${response.status} ${response.statusText}\n`;
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                output.textContent += `✅ Success! Results:\n`;
                output.textContent += `   - Domain: ${result.results[0].hostname}\n`;
                output.textContent += `   - Status: ${result.results[0].status}\n`;
                output.textContent += `   - Message: ${result.results[0].message}\n`;
                output.textContent += `   - Response Time: ${result.results[0].responseTime}ms\n`;
                
                if (result.results[0].certificate) {
                    output.textContent += `   - Issuer: ${result.results[0].certificate.issuer}\n`;
                    output.textContent += `   - Valid Until: ${result.results[0].certificate.validTo}\n`;
                    output.textContent += `   - Days Until Expiry: ${result.results[0].certificate.daysUntilExpiry}\n`;
                }
                
            } catch (error) {
                output.textContent += `❌ Error: ${error.message}\n`;
                output.textContent += `📋 Error details: ${error.stack}\n`;
            }
        }
    </script>
</body>
</html>
